(r=>{$treedatatype={Json:1,Xml:2};var l={containerid:null,url:null,async:!($treedataformat={Linear:1,Hierarchy:2}),dataset:null,datatype:$treedatatype.Json,dataformat:$treedataformat.Hierarchy,class_node_collapse:"ui-icon-folder-collapsed",class_node_expand:"ui-icon-folder-open",class_node_item:"ui-icon-document",collapse_tree:!1,class_node_highlight:"ui-state-highlight",class_node_add:"ui-icon-plusthick",class_node_remove:"ui-icon-minusthick",show_button_check:!1,show_button_add:!1,show_button_remove:!1,node_remove_message:"Are you sure you want to remove this node?",onstart:function(){},onend:function(){},onprocessingstart:function(){},onprocessingcomplete:function(){},onprocessingerror:function(e,t,n){},onbeforedataconversion:function(){},onafterdataconversion:function(){},onrenderstart:function(){},onrendercomplete:function(){},onbeforenodeinsert:function(e){},onafternodeinsert:function(e){},onselectednode:function(e,t,n){},onbeforeaddnode:function(e,t,n){},onafteraddnode:function(e,t,n){},onbeforeremovenode:function(e,t,n){},onafterremovenode:function(e,t,n){},onaddnode:function(e,t,n){},onremovenode:function(e,t,n){},onnodecheckselected:function(e,t,n){}},h=l;r.fn.btechcotree=function(e){h=r.extend({},l,e);var o=[],a="";if(h.onstart(),h.onprocessingstart(),null!=h.url&&0<h.url.length){var t="";switch(h.datatype){case 1:t="json";break;case 2:t="xml"}r.ajax({type:"GET",async:h.async,url:h.url,dataType:t,success:function(e){h.dataset=e},error:function(e,t,n){h.onprocessingerror(e,t,n)}})}switch(h.onbeforedataconversion(),h.datatype){case 1:switch(h.dataformat){case 1:(e=>{r(e).each(function(e,t){var n=(e=>{var t,n;for(n in t={id:e.id,name:e.name,parentId:e.parentId,href:e.href,target:e.target,tooltip:e.tooltip,buttoncheck:e.buttoncheck,buttonadd:e.buttonadd,buttonremove:e.buttonremove,isdisabled:e.isdisabled,ischecked:e.ischecked,classnodeicon:e.classnodeicon,childnodes:[]},e)t.hasOwnProperty(n)||(t[n]=e[n]);return t})(this);0==o.length||0==n.parentId?o.push(n):c(o,n)})})(h.dataset.root);break;case 2:o=h.dataset.root}break;case 2:switch(h.dataformat){case 1:(e=>{r(e).find("node").each(function(e,t){var n=i(this);0==o.length||0==n.parentId?o.push(n):c(o,n)})})(h.dataset);break;case 2:(e=>{r(e).find("node").each(function(e,t){var n=i(this);0==o.length||0==n.parentId?o.push(n):c(o,n)})})(h.dataset)}}h.onafterdataconversion(),h.onprocessingcomplete(),h.onrenderstart(),function n(e){0==a.length?a+="<ul style='list-style-type:none;'>":a+="<ul style='list-style-type:none; display:none;'>";r(e).each(function(e,t){h.class_node_collapse;h.onbeforenodeinsert(t),a+=d(this),h.onafternodeinsert(t),null!=this.childnodes&&0<this.childnodes.length&&n(this.childnodes)});a+="</ul>"}(o),r("#"+h.containerid).append(a);e=r.fn.btechcotree.GetRootNodes();function i(e){var t,n=0;return null!=r(e).parent().attr("id")?n=r(e).parent().attr("id"):null!=r(e).attr("parentId")&&(n=r(e).attr("parentId")),t={id:r(e).attr("id"),name:r(e).attr("name"),parentId:n,href:r(e).attr("href"),target:r(e).attr("target"),tooltip:r(e).attr("tooltip"),buttoncheck:null!=r(e).attr("buttoncheck")&&r(e).attr("buttoncheck"),buttonadd:null!=r(e).attr("buttonadd")&&r(e).attr("buttonadd"),buttonremove:null!=r(e).attr("buttonremove")&&r(e).attr("buttonremove"),isdisabled:null!=r(e).attr("isdisabled")&&r(e).attr("isdisabled"),ischecked:null!=r(e).attr("ischecked")&&r(e).attr("ischecked"),classnodeicon:r(e).attr("classnodeicon"),childnodes:[]},r(e.attributes).each(function(){t.hasOwnProperty(this.name)||(t[this.name]=this.value)}),t}function c(e,t){for(var n=0;n<e.length;n++){if(e[n].id==t.parentId){0==e[n].childnodes.length&&(e[n].childnodes=[]),e[n].childnodes.push(t);break}e[n].childnodes instanceof Object&&c(e[n].childnodes,t)}}function d(e){var t,n="",o=20,a=["id","name","parentId","href","target","tooltip","buttoncheck","buttonadd","buttonremove","isdisabled","ischecked","classnodeicon","childnodes"];for(t in n+="<li nodeid='"+e.id+"'",e)a.indexOf(t)<0&&(n+=" "+t+"='"+e[t]+"'");return n=(n+=">")+"<div>"+"<span class='ui-icon ",null!=e.classnodeicon&&0<e.classnodeicon.length?n+=e.classnodeicon:null!=e.childnodes&&0<e.childnodes.length?h.collapse_tree?n+=h.class_node_expand:n+=h.class_node_collapse:n+=h.class_node_item,n+="' data-action='nav_items' style='position:absolute; margin-top:1px;'></span>",(e.buttoncheck||null==e.buttoncheck&&h.show_button_check)&&(n+="<input type='checkbox' style='position:absolute; margin-top:1px;margin-left:"+o+"px;'",e.isdisabled&&(n+=" disabled='true'"),n=n+("true"==e.ischecked?" checked='true' data-ischecked="+e.ischecked:" data-ischecked='false'")+"></input>",o+=20),(e.buttonadd||null==e.buttonadd&&h.show_button_add)&&(n+="<span class='ui-icon "+h.class_node_add+"' data-action='add' style='position:absolute; margin-top:1px;margin-left:"+o+"px;'></span>",o+=20),(e.buttonremove||null==e.buttonremove&&h.show_button_remove)&&(n+="<span class='ui-icon "+h.class_node_remove+"' data-action='remove' style='position:absolute; margin-top:1px;margin-left:"+o+"px;'></span>",o+=20),e.href&&(n+="<a href='"+e.href+"' target='"+e.target+"'>"),n+="<span style='margin-left:"+o+"px;' data-action='text'",null!=e.tooltip&&(n+=" title='"+e.tooltip+"'"),n+=">"+e.name+"</span>",e.href&&(n+="</a>"),n=n+"</div>"+"</li>"}function n(e,t){r("#"+h.containerid+" ul li div span[data-action='text']").removeClass(h.class_node_highlight),t&&r(e).parent("div").parent("li").find("span[data-action='text']:first").addClass(h.class_node_highlight)}function s(e,t){t?(r(e).prop("checked","true"),r(e).attr("data-ischecked","true")):(r(e).removeAttr("checked"),r(e).attr("data-ischecked","false"))}r.fn.btechcotree.ToggleCaratIcon(e),r.fn.btechcotree.ToggleTree(e),h.collapse_tree&&(r.fn.btechcotree.ToggleCaratIcon(e),r.fn.btechcotree.ToggleTree(e)),r("#"+h.containerid+" ul li div").find("input[type='checkbox']").each(function(){var e;r(this).is(":checked")&&r(this).attr("data-ischecked")&&0<r(this).parent("div").parent("li").next("ul").children().find("input[type='checkbox']").length&&(e=!1,r(this).parent("div").parent("li").next("ul").children().each(function(){r(this).find("input[type='checkbox']").is(":checked")&&r(this).find("input[type='checkbox']").attr("data-ischecked")&&(e=!0)}),e||(r(this).removeAttr("checked"),r(this).attr("data-ischecked","false")))}),r("#"+h.containerid+" ul li div").find("input[type='checkbox'][checked='true']").each(function(){r(this).parents("ul").prev("li").each(function(){r(this).find("input[type='checkbox']").attr("checked","true"),r(this).find("input[type='checkbox']").attr("data-ischecked","true")})}),h.onrendercomplete(),h.onend(),r("li div span[data-action='nav_items']").bind("click",function(){r.fn.btechcotree.ToggleCaratIcon(this),r.fn.btechcotree.ToggleTree(this)}),r("li div span[data-action='text']").bind("click",function(e){h.onselectednode(r(this).parent("div").parent("li").attr("nodeid"),r(this).parent("div").parent("li"),e),n(this,!0)}),r("li div input[type='checkbox']").bind("click",function(e){var t;h.onnodecheckselected(r(this).parent("div").parent("li").attr("nodeid"),r(this).parent("div").parent("li"),e),t=r(e=this).is(":checked"),s(e,t),r(e).parent("div").parent("li").next("ul").find("input[type='checkbox']").each(function(){s(this,t)}),r(e).parents("ul").prev("li").find("div input[type='checkbox']").each(function(){s(this,t)})}),r("li div span[data-action='add']").bind("click",function(e){h.onbeforeaddnode(r(this).parent("div").parent("li").attr("nodeid"),r(this).parent("div").parent("li"),e),n(this,!0),h.onaddnode(r(this).parent("div").parent("li").attr("nodeid"),r(this).parent("div").parent("li"),e),h.onafteraddnode(r(this).parent("div").parent("li").attr("nodeid"),r(this).parent("div").parent("li"),e)}),r("li div span[data-action='remove']").bind("click",function(e){h.onbeforeremovenode(r(this).parent("div").parent("li").attr("nodeid"),r(this).parent("div").parent("li"),e),n(this,!0),confirm(h.node_remove_message)?h.onremovenode(r(this).parent("div").parent("li").attr("nodeid"),r(this).parent("div").parent("li"),e):n(this,!1),h.onafterremovenode(r(this).parent("div").parent("li").attr("nodeid"),r(this).parent("div").parent("li"),e)})},r.fn.btechcotree.GetRootNodes=function(){return r("#"+h.containerid+"> ul > li > div > span:nth-child(1)")},r.fn.btechcotree.ToggleTree=function(e){r(e).parent("div").parent("li").next("ul").toggle()},r.fn.btechcotree.ToggleCaratIcon=function(e){r(e).each(function(){r(this).hasClass(h.class_node_item)||(r(this).hasClass(h.class_node_expand)?(r(this).removeClass(h.class_node_expand),r(this).addClass(h.class_node_collapse)):(r(this).hasClass(h.class_node_collapse)&&r(this).removeClass(h.class_node_collapse),r(this).addClass(h.class_node_expand)))})},r.fn.btechcotree.ExpandCollapseTree=function(e,t){t?r(e).parent("div").parent("li").next("ul").is(":visible")||(r(e).parent("div").parent("li").next("ul").show(),r.fn.btechcotree.ToggleCaratIcon(e)):r(e).parent("div").parent("li").next("ul").is(":visible")&&(r(e).parent("div").parent("li").next("ul").hide(),r.fn.btechcotree.ToggleCaratIcon(e))},r.fn.btechcotree.Expand=function(){var e=r.fn.btechcotree.GetRootNodes();r.fn.btechcotree.ExpandCollapseTree(e,!0)},r.fn.btechcotree.Collapse=function(){var e=r.fn.btechcotree.GetRootNodes();r.fn.btechcotree.ExpandCollapseTree(e,!1)},r.fn.btechcotree.Toggle=function(){var e=r.fn.btechcotree.GetRootNodes();r.fn.btechcotree.ToggleCaratIcon(e),r.fn.btechcotree.ToggleTree(e)}})(jQuery);